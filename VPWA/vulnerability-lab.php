<html lang="en">
<head>
    <title>XSS Vulnerability Lab 1</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />    
    <link rel="stylesheet" href="../styles/vpwa.css">
    <link rel="stylesheet" href="../styles/popup.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- used to specify which version of a page to crawl 
      i.e https://example.com not https://www.example.com  or https://example.com/index.php -->
    <link rel="canonical" href="https://www.vpwa.com" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="keywords" content="seo,cheat,sheet">
    <meta name="robots" content="index,follow">
    <!-- Social Metaata
        Platforms that support Open Graph protocol include Facebook, Twitter, LinkedIn, and Pinterest.
        optimal image size:
        Twitter:
        • Minimum 144x144 px
        • No larger than 4096x4096 px or 5MB
        Facebook:
        • Minimum 600x600 px
        • Try to use images that are at least 1080 px in width
    -->
    <!-- Required Open Graph data -->
    <meta property="og:title" content="Vulnerable PHP Web Application" />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="https://www.vpwa.com/image.jpg" />
    <meta property="og:url" content="https://www.vpwa.com" />
    <!-- Optional Open Graph data -->
    <meta property="og:audio" content="https://www.vpwa.com/guide.mp3." />
    <meta property="og:description" content="Vulnerable PHP Web Application" />
    <meta property="og:site_name" content="VPWA" />
    <meta property="og:locale" content="en_us" />
    <meta property="og:video" content="https://www.vpwa.com/guide.mp4" />
    <meta property="fb:app_id" content="Your FB_APP_ID" />
    <!-- Find additional markup on https://ogp.me -->
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@ADIL">
    <meta name="twitter:title" content="Vulnerable PHH Web Application">
    <meta name="twitter:description" content="Vulnerable PHH Web Application for pentesting">
    <meta name="twitter:image" content="https://www.vpwa.com/unique-image.jpg">
</head>
<body>
<?php include "sections/navbar.php" ?>
<div class="container-fluid">
    <a href="vulnerability.php" style="float:right;color:#FFF;font-size:1em;"><i class="fa-solid fa-arrow-left-long"></i></a>
    <h1 class="titre-exp">Cross-site scripting</h1>
    <h1 class="vuln-lab-titre"><i class="fa-solid fa-flask-vial"></i>&nbsp;<b>Lab 1: </b>reflected xss - introduction</h1>
    <div id="levels">
        <?php 
        $level = 1;
        $leveltxt = "easy";
        if(!empty($_GET['level'])){
                if ($_GET['level'] == "medium") {
                    $level=2;
                    $leveltxt = "medium";
                }
                elseif ($_GET['level'] == "hard") {
                        $level=3;
                        $leveltxt = "hard";
                    }
                else{
                        $level=1;
                        $leveltxt = "easy";
                    }   
                }
        ?>
        <span>Level [ <?php echo  $leveltxt;?> ]</span>
        <a href="vulnerability-lab.php?vuln=xss&lab=1&level=easy" <?php if($level == 1)  echo 'id="active-level"';?>></a>
        <a href="vulnerability-lab.php?vuln=xss&lab=1&level=medium" <?php if($level == 2)  echo 'id="active-level"';?>></a>
        <a href="vulnerability-lab.php?vuln=xss&lab=1&level=hard" <?php if($level == 3)  echo 'id="active-level"';?>></a>
    </div>
 
    <div style="clear:both";></div>
    <div class="row">
        <div class="col-lg-6 col-sm-12 cell-padding ">  
                <div class="grey-cell-vuln vulns h-100"> 
                    <h1><b>Lab objectives:</b></h1>
                    <ul class="lab-outline">
                        <li><i class="fa-solid fa-check" style="color: #8fbd0f;"></i>use script tags to inject javascript.</li>
                        <li><i class="fa-solid fa-check" style="color: #8fbd0f;"></i>display a javascript s alert popup with this message "VPWA".</li>
                    </ul>
                    <h1><b>Expected output:</b></h1>
                    <ul class="lab-outline">
                        <li><i class="fa-solid fa-check" style="color: #8fbd0f;"></i>display a javascript  alert popup with this message "VPWA".</li>
                    </ul>
                </div>
        </div>
        <div class="col-lg-6 col-sm-12 cell-padding ">  
                <div class="grey-cell-vuln vulns h-100">
                    <h1><b>Lab Hints</b></h1> 
                    <div id="pre-hint">
                        <ul class="lab-outline">
                            <li><i class="fa-solid fa-check" style="color: #8fbd0f;"></i>only one field is vulnerable to XSS (email).</li>
                            <li><i class="fa-solid fa-check" style="color: #8fbd0f;"></i>
                                use this snippet of code for XSS injection:
                                    <Script>alet()</script>
                            </li>
                        </ul>
                        <h1><b>Expected output:</b></h1>
                        <ul class="lab-outline">
                            <li><i class="fa-solid fa-check" style="color: #8fbd0f;"></i>display a javascript  alert popup with this message "VPWA".</li>
                        </ul>
                    </div>
                    <h1 id="hint">
                        <i class="fa-solid fa-lightbulb"></i>show hints
                    </h1>
                </div>
        </div>
        <div class="col-12 cell-padding ">  
                <div class="grey-cell-vuln vulns"> 
                    <h1 style="padding:11px 0px !important;"><b>Lab Section - </b>Mark as completed&nbsp;<i class="fa-sharp fa-solid fa-circle-check"></i></h1>
                    <h1 style="padding:11px 0px !important;"><b>Add a comment</b></h1>
                    <div class="col-lg-3 col-md-7"><input type="text" name="name"  placeholder="name" /></div><br/>
                    <div class="col-lg-4 col-md-8"><input type="text" name="email"  placeholder="email" /></div><br/>
                    <textarea class="col-lg-7 col-md-10" rows="5" placeholder="message" name="message"></textarea><br/>
                    <button>ADD</button>
                </div>
        </div>
    </div>
</div>

<h1 id="copyright">VPWA designed and coded by Adil EL Mansouri</h1>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js" integrity="sha512-VK2zcvntEufaimc+efOYi622VN5ZacdnufnmX7zIhCPmjhKnOi9ZDMtg1/ug5l183f19gG1/cBstPO4D8N/Img==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js" integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript">
    $(document).ready(function(){
        var isHint = false;
        $("#hint").click(function(){
            $("#pre-hint").toggleClass("hide-info");
            $("#hint").html('<i class="fa-solid fa-lightbulb"></i>hide hints');
            isHint = !isHint;
            if (isHint == false) $("#hint").html('<i class="fa-solid fa-lightbulb"></i>show hints');
            else $("#hint").html('<i class="fa-solid fa-lightbulb"></i>hide hints');

    });
    });
</script>
</body>
</html>